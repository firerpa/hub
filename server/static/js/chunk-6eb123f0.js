import{g as $,d as A,b as D,_ as J,a as q}from"./chunk-40671842.js";import{d as I,y as F,i as m,z as E,j as H,c as z,o as f,n as l,m as x,l as d,k as U,A as O,w as K,f as w,F as R,t as j,q as y,g as k,h as N,H as P,r as Q,a as S,J as W,K as G}from"./chunk-fb406dfe.js";import{u as X}from"./chunk-86c1ba55.js";import{_ as Y}from"./chunk-34eebc1c.js";import{a as Z}from"./chunk-a7eb19bd.js";const ee=[{label:"用户名",value:"name"},{label:"联系方式",value:"contact"},{label:"超级账号",value:"admin"},{label:"登录地址",value:"last_login_from"},{label:"登录时间",value:"login_time"},{label:"注册时间",value:"reg_time"}],ae={class:"table-area"},te=I({__name:"List",setup(L,{expose:b}){const v=F(()=>g.value-180),c=m([]),{width:p,height:g}=X(),h=F(()=>p.value-200),e=m({current:1,pageSize:25,total:c.value.length,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["25","50","100"],showTotal:o=>"共 "+o+" 条"}),i=F(()=>{const o=ee.map(t=>({title:t.label,dataIndex:t.value,key:t.value,width:180,fixed:void 0,sorter:!0}));return o.push({title:"操作",dataIndex:"operation",fixed:"right",width:100,key:"operation",sorter:!1}),o}),_=m({sort:"",order:""}),u=m(!1);function n(o,t,a){e.value.current=o.current,e.value.pageSize=o.pageSize,_.value.sort=a.field,_.value.order=a.order?a.order=="ascend"?"asc":"desc":a.order,r()}const s=async o=>{var a,C;const t=await A(o);((a=t==null?void 0:t.data)==null?void 0:a.status)==0?(k.success("删除成功"),r()):k.error("删除失败："+((C=t==null?void 0:t.data)==null?void 0:C.message))},r=async o=>{o&&(e.value.current=o);try{u.value=!0;let t={page:e.value.current,size:e.value.pageSize};_.value.order&&Object.assign(t,{..._.value});const a=await $(t);a.data.data&&typeof a.data.data=="object"?(u.value=!1,c.value=a.data.data,e.value.total=a.data.total):(u.value=!1,c.value=[])}catch{u.value=!1}};return E(()=>{r()}),H(()=>{}),b({getLists:r}),(o,t)=>{const a=x("a-button"),C=x("a-popconfirm"),M=x("a-table");return f(),z("div",ae,[l(M,{columns:i.value,"data-source":c.value,pagination:e.value,scroll:{x:h.value,y:v.value},loading:u.value,onChange:n},{bodyCell:d(({text:V,record:T,index:ce,column:B})=>[B.key=="operation"?(f(),U(C,{key:0,title:"确认要删除该用户吗？","ok-text":"确定","cancel-text":"取消",onConfirm:()=>s(T.id)},{default:d(()=>[l(a,{type:"link",danger:"",onClick:t[0]||(t[0]=K(()=>{},["stop"]))},{default:d(()=>[w("删除")]),_:1})]),_:2},1032,["onConfirm"])):O("",!0),["admin"].includes(B.key)?(f(),z(R,{key:1},[w(j(V?"是":"否"),1)],64)):O("",!0),["login_time","reg_time"].includes(B.key)?(f(),z(R,{key:2},[w(j(y(Y).timestampToDate(V)),1)],64)):O("",!0)]),_:1},8,["columns","data-source","pagination","scroll","loading"])])}}}),oe=N(te,[["__scopeId","data-v-eb9b0464"]]),se=I({__name:"createUser",props:{isFormOpen:{type:Boolean,default:!1}},emits:["RefreshList"],setup(L,{emit:b}){const v=b,c=L,p=m(!1);P(()=>c.isFormOpen,n=>{p.value=n});const g={style:{width:"150px"}},h={span:14},e=Q({name:"",password:"",contact:null}),i=m(!1),_=async()=>{var s,r;if(i.value=!0,!(e.name&&e.password)){k.error("请输入用户名和密码"),i.value=!1;return}const n=await D(e);((s=n==null?void 0:n.data)==null?void 0:s.status)==0?(i.value=!1,k.success("用户创建成功"),e.name="",e.password="",e.contact="",v("RefreshList",{type:"add",isShow:!1})):(i.value=!1,k.error("用户创建失败："+((r=n==null?void 0:n.data)==null?void 0:r.message)))},u=()=>{e.name="",e.password="",e.contact="",i.value=!1,v("RefreshList",{type:"cancel",isShow:!1})};return(n,s)=>{const r=x("a-input"),o=x("a-form"),t=x("a-modal");return f(),U(t,{open:p.value,"onUpdate:open":s[3]||(s[3]=a=>p.value=a),title:"创建用户","ok-text":"确定","cancel-text":"取消","confirm-loading":i.value,onOk:_,onCancel:u},{default:d(()=>[l(o,{model:e,"label-col":g,"wrapper-col":h},{default:d(()=>[l(r,{class:"form-input",value:e.name,"onUpdate:value":s[0]||(s[0]=a=>e.name=a),placeholder:"请输入用户名"},null,8,["value"]),l(r,{class:"form-input",value:e.password,"onUpdate:value":s[1]||(s[1]=a=>e.password=a),placeholder:"请输入密码"},null,8,["value"]),l(r,{class:"form-input",value:e.contact,"onUpdate:value":s[2]||(s[2]=a=>e.contact=a),placeholder:"用户联系方式"},null,8,["value"])]),_:1},8,["model"])]),_:1},8,["open","confirm-loading"])}}}),le=N(se,[["__scopeId","data-v-0a4ca13f"]]),ne={class:"content"},re={style:{height:"100%"}},ie={class:"right-button"},de=I({__name:"index",setup(L){var g;const b=(g=Z.getUser())==null?void 0:g.admin,v=m(),c=m(!1),p=({isShow:h})=>{c.value=h,v.value.getLists(1)};return(h,e)=>{const i=x("a-tab-pane"),_=x("a-tabs"),u=x("a-button");return f(),z(R,null,[l(J,null,{default:d(()=>[S("div",ne,[S("div",re,[l(_,{type:"card",size:"small"},{default:d(()=>[l(i,{key:"1"},{tab:d(()=>[S("span",null,[l(y(W)),w("用户列表")])]),default:d(()=>[l(oe,{ref_key:"listRef",ref:v},null,512)]),_:1})]),_:1}),S("div",ie,[y(b)?(f(),U(u,{key:0,type:"link",onClick:e[0]||(e[0]=n=>p({isShow:!0}))},{default:d(()=>[l(y(G),{icon:y(q),class:"icon-margin"},null,8,["icon"]),w("创建用户 ")]),_:1})):O("",!0)])])])]),_:1}),l(le,{isFormOpen:c.value,onRefreshList:p},null,8,["isFormOpen"])],64)}}}),ve=N(de,[["__scopeId","data-v-a3a938ec"]]);export{ve as default};
