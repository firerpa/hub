import{g as $,d as A,b as D,_ as J,a as q}from"./chunk-c39da708.js";import{d as I,y as F,i as m,z as E,j as H,c as z,o as v,n as l,m as x,l as c,k as U,A as O,w as K,f as w,F as R,t as j,q as y,g as k,h as N,H as P,r as Q,a as S,J as W,K as G}from"./chunk-a3222f40.js";import{u as X}from"./chunk-f1066bb5.js";import{_ as Y}from"./chunk-67e6aa2c.js";import{a as Z}from"./chunk-a7eb19bd.js";const ee=[{label:"用户名",value:"name"},{label:"联系方式",value:"contact"},{label:"超级账号",value:"admin"},{label:"登录地址",value:"last_login_from"},{label:"登录时间",value:"login_time"},{label:"注册时间",value:"reg_time"}],ae={class:"table-area"},te=I({__name:"List",setup(L,{expose:h}){const f=F(()=>b.value-180),u=m([]),{width:p,height:b}=X(),g=F(()=>p.value-200),e=m({current:1,pageSize:25,total:u.value.length,showQuickJumper:!0,showSizeChanger:!0,pageSizeOptions:["25","50","100"],showTotal:o=>"共 "+o+" 条"}),i=F(()=>{const o=ee.map(t=>({title:t.label,dataIndex:t.value,key:t.value,width:180,fixed:void 0,sorter:!0}));return o.push({title:"操作",dataIndex:"operation",fixed:"right",width:100,key:"operation",sorter:!1}),o}),_=m({sort:"",order:""}),d=m(!1);function n(o,t,a){e.value.current=o.current,e.value.pageSize=o.pageSize,_.value.sort=a.field,_.value.order=a.order?a.order=="ascend"?"asc":"desc":a.order,r()}const s=async o=>{var a,C;const t=await A(o);((a=t==null?void 0:t.data)==null?void 0:a.status)==0?(k.success("删除成功"),r()):k.error("删除失败："+((C=t==null?void 0:t.data)==null?void 0:C.message))},r=async o=>{o&&(e.value.current=o);try{d.value=!0;let t={page:e.value.current,size:e.value.pageSize};_.value.order&&Object.assign(t,{..._.value});const a=await $(t);a.data.data&&typeof a.data.data=="object"?(d.value=!1,u.value=a.data.data,e.value.total=a.data.total):(d.value=!1,u.value=[])}catch{d.value=!1}};return E(()=>{r()}),H(()=>{}),h({getLists:r}),(o,t)=>{const a=x("a-button"),C=x("a-popconfirm"),M=x("a-table");return v(),z("div",ae,[l(M,{columns:i.value,"data-source":u.value,pagination:e.value,scroll:{x:g.value,y:f.value},loading:d.value,onChange:n},{bodyCell:c(({text:V,record:T,index:ue,column:B})=>[B.key=="operation"?(v(),U(C,{key:0,title:"确认要删除该用户吗？","ok-text":"确定","cancel-text":"取消",onConfirm:()=>s(T.id)},{default:c(()=>[l(a,{type:"link",danger:"",onClick:t[0]||(t[0]=K(()=>{},["stop"]))},{default:c(()=>[w("删除")]),_:1})]),_:2},1032,["onConfirm"])):O("",!0),["admin"].includes(B.key)?(v(),z(R,{key:1},[w(j(V?"是":"否"),1)],64)):O("",!0),["login_time","reg_time"].includes(B.key)?(v(),z(R,{key:2},[w(j(y(Y).timestampToDate(V)),1)],64)):O("",!0)]),_:1},8,["columns","data-source","pagination","scroll","loading"])])}}}),oe=N(te,[["__scopeId","data-v-eb9b0464"]]),se=I({__name:"createUser",props:{isFormOpen:{type:Boolean,default:!1}},emits:["RefreshList"],setup(L,{emit:h}){const f=h,u=L,p=m(!1);P(()=>u.isFormOpen,n=>{p.value=n});const b={style:{width:"150px"}},g={span:14},e=Q({name:"",password:"",contact:null}),i=m(!1),_=async()=>{var s,r;if(i.value=!0,!(e.name&&e.password)){k.error("请输入用户名和密码"),i.value=!1;return}const n=await D(e);((s=n==null?void 0:n.data)==null?void 0:s.status)==0?(i.value=!1,k.success("用户创建成功"),e.name="",e.password="",e.contact="",f("RefreshList",{type:"add",isShow:!1})):(i.value=!1,k.error("用户创建失败："+((r=n==null?void 0:n.data)==null?void 0:r.message)))},d=()=>{e.name="",e.password="",e.contact="",i.value=!1,f("RefreshList",{type:"cancel",isShow:!1})};return(n,s)=>{const r=x("a-input"),o=x("a-form"),t=x("a-modal");return v(),U(t,{open:p.value,"onUpdate:open":s[3]||(s[3]=a=>p.value=a),title:"创建用户","ok-text":"确定","cancel-text":"取消","confirm-loading":i.value,onOk:_,onCancel:d},{default:c(()=>[l(o,{model:e,"label-col":b,"wrapper-col":g},{default:c(()=>[l(r,{class:"form-input",value:e.name,"onUpdate:value":s[0]||(s[0]=a=>e.name=a),placeholder:"请输入用户名"},null,8,["value"]),l(r,{class:"form-input",value:e.password,"onUpdate:value":s[1]||(s[1]=a=>e.password=a),placeholder:"请输入密码"},null,8,["value"]),l(r,{class:"form-input",value:e.contact,"onUpdate:value":s[2]||(s[2]=a=>e.contact=a),placeholder:"用户联系方式"},null,8,["value"])]),_:1},8,["model"])]),_:1},8,["open","confirm-loading"])}}}),le=N(se,[["__scopeId","data-v-0a4ca13f"]]),ne={class:"content"},re={style:{height:"100%"}},ie={class:"right-button"},ce=I({__name:"index",setup(L){var b;const h=(b=Z.getUser())==null?void 0:b.admin,f=m(),u=m(!1),p=({isShow:g})=>{u.value=g,f.value.getLists(1)};return(g,e)=>{const i=x("a-tab-pane"),_=x("a-tabs"),d=x("a-button");return v(),z(R,null,[l(J,null,{default:c(()=>[S("div",ne,[S("div",re,[l(_,{type:"card",size:"small"},{default:c(()=>[l(i,{key:"1"},{tab:c(()=>[S("span",null,[l(y(W)),w("用户列表")])]),default:c(()=>[l(oe,{ref_key:"listRef",ref:f},null,512)]),_:1})]),_:1}),S("div",ie,[y(h)?(v(),U(d,{key:0,type:"link",onClick:e[0]||(e[0]=n=>p({isShow:!0}))},{default:c(()=>[l(y(G),{icon:y(q),class:"icon-margin"},null,8,["icon"]),w("创建用户 ")]),_:1})):O("",!0)])])])]),_:1}),l(le,{isFormOpen:u.value,onRefreshList:p},null,8,["isFormOpen"])],64)}}}),fe=N(ce,[["__scopeId","data-v-a3a938ec"]]);export{fe as default};
